<div *ngIf="isLoading" class="loading-indicator">
  <div class="spinner"></div>
  <span>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</span>
</div>

<div *ngIf="!isLoading">
  <div *ngIf="assignment">
    <h2>{{ assignment.title }}</h2>
    <p>{{ assignment.description }}</p>
    <p>–°—Ä–æ–∫ —Å–¥–∞—á–∏: {{ assignment.dueDate | date:'dd.MM.yyyy' }}</p>

    <section class="files-section">
      <h3>–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</h3>
      <ul class="file-list">
        <li *ngFor="let m of manuals">
          <a (click)="openPdf(m.downloadUrl, m.fileName)" class="file-link">
            üìÑ {{ m.fileName }}
          </a>
          <!-- –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ -->
          <button
            *ngIf="role === 'ROLE_TEACHER'"
            (click)="confirmDelete(m)"
            class="delete-btn"
          >
            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
          </button>
        </li>
      </ul>

      <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç–æ–¥–∏—á–µ–∫ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º -->
      <div *ngIf="role === 'ROLE_TEACHER'" class="upload-box">
        <h4>–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª</h4>
        <input type="file" (change)="onManualFileSelected($event)" class="file-input">
        <button
          (click)="uploadManual()"
          [disabled]="!manualFile"
          class="upload-button"
        >
          {{ manualFile ? '–ó–∞–≥—Ä—É–∑–∏—Ç—å' : '–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª' }}
        </button>
      </div>
    </section>

    <!-- –°–µ–∫—Ü–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ -->
    <section *ngIf="role === 'ROLE_STUDENT'" class="student-section">
      <div class="upload-box">
        <h3>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ</h3>
        <input type="file" (change)="onStudentFileSelected($event)" class="file-input">
        <button
          (click)="uploadStudent()"
          [disabled]="!studentFile"
          class="upload-button"
        >
          {{ studentFile ? '–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª' : '–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª' }}
        </button>
      </div>

      <div *ngIf="studentSubmissions.length" class="submissions">
        <h4>–í–∞—à–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–¥–∞—á–∏:</h4>
        <ul class="submission-list">
          <li *ngFor="let s of studentSubmissions" class="submission-item">
            <a (click)="openPdf(s.downloadUrl, s.fileName)" class="file-link">
              üì§ {{ s.fileName }}
            </a>
            <button
              (click)="confirmDelete(s)"
              class="delete-btn"
            >
              üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
            </button>
          </li>
        </ul>
      </div>
    </section>

    <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è -->
    <section *ngIf="role === 'ROLE_TEACHER'" class="teacher-section">
      <div *ngIf="studentSubmissions.length">
        <h3>–†–∞–±–æ—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–∞</h3>
        <ul class="submission-list">
          <li *ngFor="let s of studentSubmissions" class="submission-item">
            <a (click)="openPdf(s.downloadUrl, s.fileName)" class="file-link">
              üì§ {{ s.fileName }} ({{ s.submittedAt | date:'dd.MM.yyyy HH:mm' }})
            </a>
            <div class="grade-control">
              <input
                type="number"

                min="0"
                max="100"
                placeholder="–û—Ü–µ–Ω–∫–∞"
                class="grade-input"
              >
              <button
                (click)="saveGrade(s)"
                class="save-btn"
              >
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫—É
              </button>
            </div>
          </li>
        </ul>
      </div>
    </section>
  </div>

  <div *ngIf="!assignment" class="no-data">
    –ó–∞–¥–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
  </div>
</div>
